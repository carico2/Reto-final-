<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Panel de Administrador - Ing Aya</title>
  <style>
    body {
      font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
      background-image: url("../imagenes/Proyecto-nuevo-2025-03-05T174814.714.jpg");
      margin: 0;
      padding: 0;
      color: #fff;
      display: flex;
      height: 100vh;
      overflow: hidden; /* Para que las ondas no hagan scroll */
    }

    /* Fondo con ondas */
        .waves {
      position: fixed;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle at 50% 50%, rgba(0, 180, 255, 0.12), transparent 70%);
      animation: moveWaves 50s linear infinite; /* M√°s lento = menos frames */
      z-index: -1;
    }

    .waves::before,
    .waves::after {
      content: "";
      position: absolute;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle at 30% 30%, rgba(0, 255, 200, 0.12), transparent 70%);
      animation: moveWaves 25s linear infinite reverse;
    }

    .waves::after {
      background: radial-gradient(circle at 70% 70%, rgba(255, 0, 200, 0.12), transparent 70%);
      animation-duration: 35s;
    }

    @keyframes moveWaves {
    from { transform: rotate(0deg) scale(1); }
    to { transform: rotate(360deg) scale(1.1); }
    }

    /* Sidebar */
    .sidebar {
      width: 250px;
      background-color: #111;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 15px;
      z-index: 1;
    }

    .sidebar a {
      background-color: #333;
      color: white;
      padding: 12px;
      border-radius: 8px;
      text-decoration: none;
      font-weight: bold;
      transition: background-color 0.3s ease;
    }

    .sidebar a:hover {
      background-color: #2a3896;
    }

    /* √Årea principal */
    .main {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      position: relative;
      z-index: 1;
    }

    /* Perfil arriba a la derecha */
    .perfil {
      position: absolute;
      top: 30px;
      right: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .avatar {
      width: 60px;
      height: 80px;
      border-radius: 50%;  
      border: 0px solid #444;
      object-fit: cover;  
    }

    .main .principal{
      width:  300px;
      filter: blur(0px);
    }

    /* Imagen central */
    .main img {
      width:100px;
      margin-bottom: 10px;
      opacity: 0.8;
    }

    /* Mensaje de bienvenida */
    #mensaje {
      font-size: 1.5em;
      font-weight: bold;
      color: #ffffff;
      opacity: 0;
      transition: opacity 1s ease-in-out;
    }
  </style>
</head>
<body>
  <!-- Fondo de ondas -->
  <div class="waves"></div>

  <!-- Sidebar -->
  <div class="sidebar">
    <a href="http://127.0.0.1:5000">üôç‚Äç‚ôÇÔ∏è Gesti√≥n de Usuarios</a>
    <button id="btnGenerarReporte" class="btn-primary" style="margin: 20px auto; display: block; padding: 8px 16px; font-size: 14px;">Generar Reporte B√°sico</button>
    
            <script>
                document.getElementById('btnGenerarReporte').addEventListener('click', async () => {
                    // API endpoint for Rutas Zonales del SITP dataset
                    const apiUrl = "https://gis.transmilenio.gov.co/arcgis/rest/services/Zonal/consulta_rutas_zonales/MapServer/0/query?where=1%3D1&outFields=*&f=json&resultRecordCount=100";
                    try {
                        const response = await fetch(apiUrl);
                        if (!response.ok) {
                            alert('Error al obtener datos de la API: ' + response.statusText);
                            return;
                        }
                        const json = await response.json();
                        const data = json.features;
                        if (!data || data.length === 0) {
                            alert('No se encontraron datos en la API.');
                            return;
                        }
                        // Prepare CSV content
                        const csvRows = [];
                        // Header - all fields from metadata
                        const headers = [
                            "abreviatura_destino_zona_sitp",
                            "codigo_definitivo_ruta_zonal",
                            "delega_ruta_zonal",
                            "denominacion_ruta_zonal",
                            "destino_ruta_zonal",
                            "destino_zona_sitp",
                            "fecha_implementacion_ruta_zonal",
                            "globalid",
                            "localidad_destino_ruta_zonal",
                            "localidad_origen_ruta_zonal",
                            "longitud_ruta_zonal",
                            "objectid",
                            "operador_ruta_zonal",
                            "origen_ruta_zonal",
                            "route_id_ruta_zonal",
                            "route_name_ruta_zonal",
                            "tipo_operacion",
                            "tipo_ruta_zonal",
                            "tipo_servicio_ruta_zonal",
                            "zona_destino_ruta_zonal",
                            "zona_origen_ruta_zonal"
                        ];
                        csvRows.push(headers.join(','));
                        // Data rows
                        data.forEach(item => {
                            const attributes = item.attributes;
                            const row = headers.map(field => {
                                let val = attributes[field];
                                if (val === null || val === undefined) val = '';
                                // Escape quotes in strings
                                if (typeof val === 'string') {
                                    val = `"${val.replace(/"/g, '""')}"`;
                                }
                                return val;
                            });
                            csvRows.push(row.join(','));
                        });
                        const csvString = csvRows.join('\n');
                        // Create a blob and trigger download
                        const blob = new Blob([csvString], { type: 'text/csv' });
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.setAttribute('hidden', '');
                        a.setAttribute('href', url);
                        a.setAttribute('download', 'rutas_zonales_sitp.csv');
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                        window.URL.revokeObjectURL(url);
                    } catch (error) {
                        alert('Error al generar el reporte: ' + error.message);
                    }
                });
            </script>
    <a href="configuracion.html">‚öôÔ∏è Configuraci√≥n</a>
  </div>

  <!-- Contenido principal -->
  <div class="main">
    <!-- Perfil -->
    <div class="perfil">
      <span>Admin</span>
    </div>

    <!-- Imagen central -->
    <img src="https://png.pngtree.com/png-vector/20221124/ourmid/pngtree-recruitment-job-for-social-media-admin-png-image_6478542.png" alt="Engranaje con sombrero" class="principal">
    <p>ING AYA</p>

    <!-- Mensaje animado -->
    <div id="mensaje">¬°Bienvenido Administrador!</div>
  </div>

  <script>
    // Animaci√≥n de mensaje al entrar
    window.onload = function() {
      const mensaje = document.getElementById("mensaje");
      setTimeout(() => {
        mensaje.style.opacity = 1;
      }, 500);
    }
  </script>
</body>
</html>
